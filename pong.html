<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pong</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap">
    <style>
body {
    margin: 0;
    overflow: hidden;
    background-color: #176785;
}

p {
    font-size: 18px;
}

.randomEvent {
    top: 24%;
    left: 50%;
    font-size: 28px;
    color: #ff3b30;
    padding: 20px;
    z-index: 100;
}

#startMenu {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #176785;
}

#startMenu .title {
    font-size: 48px;
    color: #ffffff;
    margin-bottom: 20px;
}

#startMenu .button-container {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 20px;
}

button {
    padding: 12px 24px;
    font-size: 18px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s;
}

button:hover {
    background-color: #45a049;
}

canvas {
    display: block;
    margin: 0 auto;
    border: 28px solid #000000;
    background-color: #000000;
    box-sizing: border-box;
    z-index: 1;
}

#scoreboard {
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    align-items: center;
}

#player1Score {
    font-size: 24px;
    color: #45aee6;
    margin: 0 10px;
}

#player2Score {
    font-size: 24px;
    color: #e65045;
    margin: 0 10px;
}

#gameResult {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    font-size: 24px;
}
</style>
</head>
<body>
    <div id="startMenu">
        <h1 id="title" class="title"></h1>
        <div class="button-container">
            <button id="startButton">Start</button>
            <button id="controlsButton">Controls</button>
        </div>
    </div>

    <div id="controlsPage" style="display: none;">
        <h1>Controls</h1>
        <p>Player 1: W + S, Player 2: ArrowUp + Arrow Down</p>
        <button id="backButton">Back</button>
    </div>

    <div id="gamemodeMenu" style="display: none;">
        <h1>Choose a gamemode</h1>
        <div class="button-container">
            <button id="singleButton">Singleplayer</button>
            <button id="multiButton">Multiplayer</button>
        </div>
    </div>

    <div id="difficultyMenu" style="display: none;">
        <h1>Choose a difficulty</h1>
        <div class="button-container">
            <button id="easyButton">Easy</button>
            <button id="mediumButton">Medium</button>
            <button id="hardButton">Hard</button>
            <button id="impossibleButton">Impossible</button>
        </div>
    </div>

    <canvas id="pongCanvas" style="display: none;"></canvas>
    <div id="eventText" class="randomEvent" style="position: absolute; transform: translate(-50%, -50%); display: none;"></div>

    <div id="scoreboard">
        <p id="player1Score" style="font-size: 24px;">0</p>
        <p style="color: #ffffff; font-size: 24px;">-</p>
        <p id="player2Score" style="font-size: 24px;">0</p>
    </div>

    <div id="gameResult" style="display: none;"></div>

    <script>
        function getPong(){const _0x29182b=['RyCEv','__proto__','log','DigXg','SPckW','viUZA','zqnDC','410047LGyulj','bind','title','fTDrP','error','toString','1977208MFrycV','cNtyl','zsmIi','prototype','inzef','Vfuih','lXVKd','search','8ZaPUJb','qDeVy','getElementById','WhWbY','apply','FhyoH','(((.+)+)+)+$','1049325bkbuzx','info','KGoGW','hvjPU','constructor','OMoGj','gmbas','OjYVO','length','190Rzyqva','dcSHQ','2730yzaBiG','textContent','aPekw','bZjPC','YDYPe','ZwDLm','{}.constructor(\x22return\x20this\x22)(\x20)','zNWNl','nzlZt','9606gsVDxY','tlicY','59442qhxtrL','DSskO','yjtMo','exception','TNagT','9388431fTQAxl','return\x20(function()\x20','YghYH','7130746MtsdWi','gBcrL','VtdEe','warn','trace','6WXqWXv','console'];_0x1056=function(){return _0x29182b;};return _0x1056();}(function(_0x319f9b,_0x32b1dd){const _0x1183e4=_0x2e42,_0x5c5475=_0x319f9b();while(!![]){try{const _0x172bf5=parseInt(_0x1183e4(0x19f))/0x1*(-parseInt(_0x1183e4(0x16b))/0x2)+-parseInt(_0x1183e4(0x189))/0x3+-parseInt(_0x1183e4(0x17a))/0x4+-parseInt(_0x1183e4(0x194))/0x5*(-parseInt(_0x1183e4(0x19d))/0x6)+parseInt(_0x1183e4(0x166))/0x7*(-parseInt(_0x1183e4(0x182))/0x8)+parseInt(_0x1183e4(0x163))/0x9+parseInt(_0x1183e4(0x192))/0xa*(parseInt(_0x1183e4(0x174))/0xb);if(_0x172bf5===_0x32b1dd)break;else _0x5c5475['push'](_0x5c5475['shift']());}catch(_0x5ae587){_0x5c5475['push'](_0x5c5475['shift']());}}}(_0x1056,0x8eb27));const _0x5599f3=(function(){let _0xd6ef4f=!![];return function(_0x1954be,_0x43a7ea){const _0x6ea546=_0xd6ef4f?function(){const _0x443fb8=_0x2e42;if(_0x43a7ea){const _0x1b5264=_0x43a7ea[_0x443fb8(0x186)](_0x1954be,arguments);return _0x43a7ea=null,_0x1b5264;}}:function(){};return _0xd6ef4f=![],_0x6ea546;};}()),_0x58d530=_0x5599f3(this,function(){const _0xfab7d9=_0x2e42,_0x1ce54b={'inzef':_0xfab7d9(0x188)};return _0x58d530['toString']()[_0xfab7d9(0x181)](_0x1ce54b[_0xfab7d9(0x17e)])[_0xfab7d9(0x179)]()[_0xfab7d9(0x18d)](_0x58d530)[_0xfab7d9(0x181)](_0x1ce54b['inzef']);});_0x58d530();const _0x12c38e=(function(){const _0x13feb5=_0x2e42,_0x24f39d={'zsmIi':function(_0x19ba04,_0x14c255){return _0x19ba04(_0x14c255);},'krIPi':function(_0x599bfc,_0xfdf0af){return _0x599bfc+_0xfdf0af;},'TNagT':function(_0x3da477,_0x49246a){return _0x3da477+_0x49246a;},'tlicY':_0x13feb5(0x164),'aPekw':_0x13feb5(0x19a),'bZjPC':function(_0xb1cc6e){return _0xb1cc6e();},'viUZA':_0x13feb5(0x16f),'KGoGW':_0x13feb5(0x169),'nwwGi':'info','wWvDK':_0x13feb5(0x178),'DSskO':_0x13feb5(0x161),'FhyoH':'table','ZBMuJ':_0x13feb5(0x16a),'OMoGj':function(_0x4223aa,_0x15ce4a){return _0x4223aa<_0x15ce4a;},'XcIoN':_0x13feb5(0x165),'gBcrL':_0x13feb5(0x160),'Vfuih':function(_0x232f94,_0x5dad8d){return _0x232f94===_0x5dad8d;}};let _0x446271=!![];return function(_0x1cd434,_0x584eb4){const _0x290779=_0x13feb5,_0x22aa92={'ZwDLm':_0x24f39d['XcIoN'],'OjYVO':_0x24f39d[_0x290779(0x167)]};if(_0x24f39d[_0x290779(0x17f)](_0x290779(0x171),_0x290779(0x19b))){let _0x433fc9;try{const _0x4dcdca=_0x24f39d[_0x290779(0x17c)](_0xb7de9f,_0x24f39d['krIPi'](_0x24f39d[_0x290779(0x162)](_0x24f39d[_0x290779(0x19e)],_0x24f39d[_0x290779(0x196)]),');'));_0x433fc9=_0x24f39d[_0x290779(0x197)](_0x4dcdca);}catch(_0x3d293e){_0x433fc9=_0x35ca88;}const _0x4c4b3d=_0x433fc9[_0x290779(0x16c)]=_0x433fc9['console']||{},_0x23afd4=[_0x24f39d[_0x290779(0x172)],_0x24f39d[_0x290779(0x18b)],_0x24f39d['nwwGi'],_0x24f39d['wWvDK'],_0x24f39d[_0x290779(0x15f)],_0x24f39d[_0x290779(0x187)],_0x24f39d['ZBMuJ']];for(let _0x55709d=0x0;_0x24f39d[_0x290779(0x18e)](_0x55709d,_0x23afd4[_0x290779(0x191)]);_0x55709d++){const _0x3d55ae=_0x50f71b[_0x290779(0x18d)][_0x290779(0x17d)][_0x290779(0x175)](_0x43d753),_0x2b3413=_0x23afd4[_0x55709d],_0x1d5cc0=_0x4c4b3d[_0x2b3413]||_0x3d55ae;_0x3d55ae[_0x290779(0x16e)]=_0xd44878[_0x290779(0x175)](_0x213229),_0x3d55ae['toString']=_0x1d5cc0[_0x290779(0x179)][_0x290779(0x175)](_0x1d5cc0),_0x4c4b3d[_0x2b3413]=_0x3d55ae;}}else{const _0x5a4de8=_0x446271?function(){const _0x6906a=_0x290779;if(_0x22aa92[_0x6906a(0x199)]===_0x22aa92[_0x6906a(0x190)])_0x41b076=_0x1cb0ba;else{if(_0x584eb4){const _0x66bd6=_0x584eb4[_0x6906a(0x186)](_0x1cd434,arguments);return _0x584eb4=null,_0x66bd6;}}}:function(){};return _0x446271=![],_0x5a4de8;}};}()),_0x4e24a8=_0x12c38e(this,function(){const _0x2624d2=_0x2e42,_0x5385f6={'qqwPa':function(_0x12fd2f,_0x485549){return _0x12fd2f(_0x485549);},'fTDrP':function(_0x3e404f,_0x2a0298){return _0x3e404f+_0x2a0298;},'DigXg':_0x2624d2(0x164),'WhWbY':'{}.constructor(\x22return\x20this\x22)(\x20)','VtdEe':function(_0x1dd5be){return _0x1dd5be();},'nzlZt':_0x2624d2(0x169),'zqnDC':_0x2624d2(0x161),'nnCeF':'table','gmbas':function(_0x233d72,_0x3f9651){return _0x233d72<_0x3f9651;},'hvjPU':function(_0x311d85,_0x18072d){return _0x311d85===_0x18072d;},'cNtyl':_0x2624d2(0x198)};let _0x10d0d9;try{const _0x59f452=_0x5385f6['qqwPa'](Function,_0x5385f6['fTDrP'](_0x5385f6[_0x2624d2(0x177)](_0x5385f6[_0x2624d2(0x170)],_0x5385f6[_0x2624d2(0x185)]),');'));_0x10d0d9=_0x5385f6[_0x2624d2(0x168)](_0x59f452);}catch(_0x5d5d77){_0x10d0d9=window;}const _0x5543f5=_0x10d0d9[_0x2624d2(0x16c)]=_0x10d0d9[_0x2624d2(0x16c)]||{},_0x19ceee=[_0x2624d2(0x16f),_0x5385f6[_0x2624d2(0x19c)],_0x2624d2(0x18a),_0x2624d2(0x178),_0x5385f6[_0x2624d2(0x173)],_0x5385f6['nnCeF'],'trace'];for(let _0x456d48=0x0;_0x5385f6[_0x2624d2(0x18f)](_0x456d48,_0x19ceee[_0x2624d2(0x191)]);_0x456d48++){if(_0x5385f6[_0x2624d2(0x18c)](_0x5385f6[_0x2624d2(0x17b)],_0x2624d2(0x193))){const _0x3bb0fc=_0x5a2796[_0x2624d2(0x186)](_0x1404de,arguments);return _0x386495=null,_0x3bb0fc;}else{const _0x252c7c=_0x12c38e[_0x2624d2(0x18d)][_0x2624d2(0x17d)][_0x2624d2(0x175)](_0x12c38e),_0x4b2dc5=_0x19ceee[_0x456d48],_0x47d024=_0x5543f5[_0x4b2dc5]||_0x252c7c;_0x252c7c[_0x2624d2(0x16e)]=_0x12c38e['bind'](_0x12c38e),_0x252c7c['toString']=_0x47d024[_0x2624d2(0x179)][_0x2624d2(0x175)](_0x47d024),_0x5543f5[_0x4b2dc5]=_0x252c7c;}}});function _0x2e42(_0xfe61f4,_0x2afdbd){const _0x5f4353=_0x1056();return _0x2e42=function(_0x2caaa7,_0xa8c135){_0x2caaa7=_0x2caaa7-0x15f;let _0x46c795=_0x5f4353[_0x2caaa7];return _0x46c795;},_0x2e42(_0xfe61f4,_0x2afdbd);}_0x4e24a8();function _0x75fd54(){const _0x4e1fc7=_0x2e42,_0xb4459e={'pfraQ':_0x4e1fc7(0x176),'lXVKd':'Super\x20Glitchy\x20Pong\x20Game\x201.1\x20(with\x20a\x20few\x20AI\x20bugs\x20lol)','RyCEv':function(_0x582734,_0x308731){return _0x582734-_0x308731;},'qDeVy':function(_0x21b533,_0x424895){return _0x21b533-_0x424895;}},_0x3ed246=0x1d,_0x540998=0x123,_0xaa4a0a=0x3f,_0x29e4e1=0x2f;var _0x5c695d=_0x3ed246+_0x540998-_0xaa4a0a+_0x29e4e1;document[_0x4e1fc7(0x184)](_0xb4459e['pfraQ'])[_0x4e1fc7(0x195)]=_0xb4459e[_0x4e1fc7(0x180)];var _0x56980a=_0xb4459e[_0x4e1fc7(0x16d)](_0xb4459e[_0x4e1fc7(0x183)](_0x3ed246,_0x540998)+_0xaa4a0a,_0x29e4e1);}
        let startMenu = document.getElementById('startMenu');
        let controlsPage = document.getElementById('controlsPage');
        let gamemodeMenu = document.getElementById('gamemodeMenu');
        let difficultyMenu = document.getElementById('difficultyMenu');
        let canvas = document.getElementById('pongCanvas');
        let ctx = canvas.getContext('2d');
        let keysPressed = {};
        let AIConfiguration = {
                speed: 0,
                reactionTime: 2000
        };
        let randomTargetY = null;
        let player1, player2, ball, drawInterval, eventInterval, oldSpeedX, oldSpeedY;
        let AIMovementDelayed = false;
        let AI = false;
       
        showStartMenu();
       
        document.getElementById('startButton').addEventListener('click', () => {
            hideStartMenu();
            showGamemodeMenu();
        });
       
        document.getElementById('controlsButton').addEventListener('click', () => {
            hideStartMenu();
            showControlsPage();
        });

        document.getElementById('backButton').addEventListener('click', () => {
            showStartMenu();
            hideControlsPage();
        });

        document.getElementById('singleButton').addEventListener('click', () => {
            hideGamemodeMenu();
            showDifficultyMenu();
            AI = true;
        });

        document.getElementById('multiButton').addEventListener('click', () => {
            hideGamemodeMenu();
            startGame();
        });

        document.getElementById('easyButton').addEventListener('click', () => {
            if (AI == true) {
                AIConfiguration.speed = 8;
                AIConfiguration.reactionTime = 2000;
                startGame();
            }
        });
        
        document.getElementById('mediumButton').addEventListener('click', () => {
            if (AI == true) {
                AIConfiguration.speed = 10;
                AIConfiguration.reactionTime = 1000;
                startGame();
            }
        });
        
        document.getElementById('hardButton').addEventListener('click', () => {
            if (AI == true) {
                AIConfiguration.speed = 12;
                AIConfiguration.reactionTime = 500;
                startGame();
            }
        });

        document.getElementById('impossibleButton').addEventListener('click', () => {
            if (AI == true) {
                AIConfiguration.speed = 14;
                AIConfiguration.reactionTime = 250;
                startGame();
            }
        });
        
        function moveAI() {
            if (AI == true) {
                let aiPaddleCenter = player2.y + player2.height / 2;
                if (AIMovementDelayed) {
                    /*
                    if (randomTargetY === null) {
                        randomTargetY = Math.random() * (canvas.height - player2.height);
                    }
        
                    if (player2.y < randomTargetY) {
                        player2.y += AIConfiguration.speed;
                    } else if (player2.y > randomTargetY) {
                        player2.y -= AIConfiguration.speed;
                    }
        
                    if (Math.abs(player2.y - randomTargetY) < 1) {
                        randomTargetY = null;
                    }
                    */
                } else {
                    if (ball.y < aiPaddleCenter - AIConfiguration.speed) {
                        player2.y -= AIConfiguration.speed;
                    } else if (ball.y > aiPaddleCenter + AIConfiguration.speed) {
                        player2.y += AIConfiguration.speed;
                    }
                }
        
                player2.y = Math.max(0, Math.min(canvas.height - player2.height, player2.y));
            }
        }
       
        function showStartMenu() {
            startMenu.style.display = 'flex';
            controlsPage.style.display = 'none';
            gamemodeMenu.style.display = 'none';
            canvas.style.display = 'none';
        }
       
        function hideStartMenu() {
            startMenu.style.display = 'none';
        }
       
        function showControlsPage() {
            controlsPage.style.display = 'block';
        }

        function hideControlsPage() {
            controlsPage.style.display = 'none';
        }
       
        function showGameCanvas() {
            canvas.style.display = 'block';
        }

        function hideGameCanvas() {
            canvas.style.display = 'none';
        }

        function showGamemodeMenu() {
            gamemodeMenu.style.display = 'block';
        }

        function hideGamemodeMenu() {
            gamemodeMenu.style.display = 'none';
        }

        function showDifficultyMenu() {
            difficultyMenu.style.display = 'block';
        }

        function hideDifficultyMenu() {
            difficultyMenu.style.display = 'none';
        }
       
        function resizeCanvas() {
            canvas.width = window.innerWidth - 28;
            canvas.height = window.innerHeight - 28;
        }
       
        function increaseBallSpeed() {
            if (Math.abs(ball.speedX) < ball.maxSpeed) {
                ball.speedX += ball.speedIncrement * Math.sign(ball.speedX);
            }
            if (Math.abs(ball.speedY) < ball.maxSpeed) {
                ball.speedY += ball.speedIncrement * Math.sign(ball.speedY);
            }
        }
       
        function resetBall() {
            ball.x = canvas.width / 2;
            ball.y = canvas.height / 2;
            ball.speedX = 5;
            ball.speedY = 5;
        }
       
        function keyDownHandler(e) {
            keysPressed[e.key] = true;
        }
       
        function keyUpHandler(e) {
            keysPressed[e.key] = false;
        }
       
        function drawPaddle(x, y, color, height) {
            const paddleWidth = 25;
            ctx.fillStyle = color;
            ctx.fillRect(x, y, paddleWidth, height);
        }
       
        function handleRandomEvent() {
            const randomEvent = Math.floor(Math.random() * 14) + 1;
            var eventText = "";
            switch (randomEvent) {
                case 1:
                    ball.speedX = Math.floor(ball.speedX / 2);
                    ball.speedY = Math.floor(ball.speedY / 2);
                    eventText = 'Calming Ball';
                    break;
                case 2:
                    ball.speedX *= 2;
                    ball.speedY *= 2;
                    ball.speedX = Math.min(ball.speedX, ball.maxSpeed);
                    ball.speedY = Math.min(ball.speedY, ball.maxSpeed);
                    eventText = 'Raging Ball';
                    break;
                case 3:
                    player1.height += 80;
                    player2.height += 80;
                    setTimeout(() => {
                        player1.height -= 80;
                        player2.height -= 80;
                    }, 5000);
                    eventText = 'Large Paddles';
                    break;
                case 4:
                    player1.height -= 80;
                    player2.height -= 80;
                    setTimeout(() => {
                        player1.height += 80;
                        player2.height += 80;
                    }, 5000);
                    eventText = 'Small Paddles';
                    break;
                case 5:
                    ball.color = '#7dcbff';
                    oldSpeedX = ball.speedX;
                    oldSpeedY = ball.speedY;
                    ball.speedX = 0;
                    ball.speedY = 0;
                    setTimeout(() => {
                        ball.color = 'white';
                        ball.speedX = oldSpeedX;
                        ball.speedY = oldSpeedY;
                    }, 5000);
                    eventText = 'Frozen Ball';
                    break;
                case 6:
                    ball.speedX = -ball.speedX;
                    ball.speedY = -ball.speedY;
                    eventText = 'Telekinesis Ball';
                    break;
                case 7:
                    oldX = ball.x;
                    oldY = ball.y;
                    ball.color = '#ff7569';
                    setTimeout(() => {
                        ball.x = oldX;
                        ball.y = oldY;
                        ball.color = 'white'
                    }, 5000)
                    eventText = 'Teleportation Ball';
                    break;
                case 8:
                    oldSpeedX = ball.speedX;
                    oldSpeedY = ball.speedY;
                    ball.speedX *= 2;
                    ball.speedY *= 2;
                    ball.speedX = Math.min(ball.speedX, ball.maxSpeed);
                    ball.speedY = Math.min(ball.speedY, ball.maxSpeed);
                    setTimeout(() => {
                        ball.speedX = oldSpeedX;
                        ball.speedY = oldSpeedY;
                    }, 2000)
                    eventText = 'Jumpscare Ball';
                    break;
                case 9:
                    ball.color = 'black';
                    var blinkIntervalBall = setInterval(() => {
                        if (ball.color == 'white') {
                            ball.color = 'black';
                        } else if (ball.color == 'black') {
                            ball.color = 'white';
                        }
                    }, 1000);
                    setTimeout(() => {
                        clearInterval(blinkIntervalBall);
                        ball.color = 'white';
                    }, 5000)
                    eventText = 'Blinking Ball';
                    break;
                case 10:
                    player1.height += 160;
                    player2.height += 160;
                    setTimeout(() => {
                        player1.height -= 160;
                        player2.height -= 160;
                    }, 5000);
                    eventText = 'Gigantic Paddles';
                    break;
                case 11:
                    oldPlayer1Color = player1.color;
                    oldPlayer2Color = player2.color;

                    player1.color = 'black';
                    player2.color = 'black';

                    var blinkIntervalPaddles = setInterval(() => {
                        if (player1.color == 'black') {
                            player1.color = oldPlayer1Color;
                            player2.color = oldPlayer2Color;
                        } else if (player1.color == oldPlayer1Color) {
                            player1.color = 'black';
                            player2.color = 'black';
                        }
                    }, 1000);
                    
                    setTimeout(() => {
                        clearInterval(blinkIntervalPaddles);
                        player1.color = oldPlayer1Color;
                        player2.color = oldPlayer2Color;
                    }, 5000)
                    eventText = 'Blinking Paddles';
                    break;
                case 12:
                    oldUp1 = player1.up
                    oldDown1 = player1.down
                    oldUp2 = player2.up
                    oldDown2 = player2.down
                    player1.up = oldDown1
                    player1.down = oldUp1
                    player2.up = oldDown2
                    player2.down = oldUp2
                    
                    setTimeout(() => {
                        player1.up = oldUp1
                        player1.down = oldDown1
                        player2.up = oldUp2
                        player2.down = oldDown2
                    }, 5000)
                    eventText = 'Reversed Controls'
                    break;
                case 13:
                    oldSpeed1 = player1.speed
                    oldSpeed2 = player2.speed
                    player1.speed *= 2
                    player2.speed *= 2
                    setTimeout(() => {
                        player1.speed = oldSpeed1
                        player2.speed = oldSpeed2
                    }, 5000) 
                    eventText = 'Fast Paddles'
                    break;
                case 14:
                    oldSpeed1 = player1.speed
                    oldSpeed2 = player2.speed
                    player1.speed /= 2
                    player2.speed /= 2
                    if (AI == true) {
                        oldSpeed3 = AIConfiguration.speed
                        AIConfiguration.speed /= 2
                    }
                    setTimeout(() => {
                        player1.speed = oldSpeed1
                        player2.speed = oldSpeed2
                        if (AI == true) {
                            AIConfiguration.speed = oldSpeed3
                        }
                    }, 5000) 
                    eventText = 'Slow Paddles'
                    break;
            }
       
            const eventTextElement = document.getElementById('eventText');
            eventTextElement.textContent = eventText;
       
            eventTextElement.style.display = 'block';
       
            setTimeout(() => {
                eventTextElement.style.display = 'none';
            }, 1500);
        }
       
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
       
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
            ctx.fillStyle = ball.color;
            ctx.fill();
            ctx.closePath();
       
            drawPaddle(player1.x, player1.y, player1.color, player1.height);
            drawPaddle(player2.x, player2.y, player2.color, player2.height);
       
            if (ball.speedX != 0 || ball.speedY != 0) {
                ball.x += ball.speedX;
                ball.y += ball.speedY;
            }

            if (
                ball.x - ball.radius < player1.x + 25 &&
                ball.y > player1.y &&
                ball.y < player1.y + player1.height
            ) {
                if (ball.y + ball.radius < player1.y || ball.y - ball.radius > player1.y + player1.height) {
                    ball.speedX = -ball.speedX;
                    increaseBallSpeed();

                    if (AI == true) {
                        if (AIMovementDelayed == false) {
                            AIMovementDelayed = true;
                            setTimeout(() => {
                                AIMovementDelayed = false;
                            }, AIConfiguration.reactionTime);
                        }
                    }
                }
            }
            
            if (
                ball.x + ball.radius > player2.x &&
                ball.y > player2.y &&
                ball.y < player2.y + player2.height
            ) {
                if (ball.y + ball.radius < player2.y || ball.y - ball.radius > player2.y + player2.height) {
                    ball.speedX = -ball.speedX;
                    increaseBallSpeed();

                    if (AI == true) {
                        if (AIMovementDelayed == false) {
                            AIMovementDelayed = true;
                            setTimeout(() => {
                                AIMovementDelayed = false;
                            }, AIConfiguration.reactionTime);
                        }
                    }
                }
            }
       
            if (ball.y + ball.radius >= canvas.height || ball.y - ball.radius <= 0) {
                ball.speedY = -ball.speedY;
            }
       
            if (
                ball.x - ball.radius < player1.x + 25 &&
                ball.y > player1.y &&
                ball.y < player1.y + player1.height
            ) {
                ball.speedX = -ball.speedX;
                increaseBallSpeed();

                
            }
       
            if (
                ball.x + ball.radius > player2.x &&
                ball.y > player2.y &&
                ball.y < player2.y + player2.height
            ) {
                ball.speedX = -ball.speedX;
                increaseBallSpeed();
            }
       
            if (ball.x - ball.radius < 0) {
                player2.score++;
                const player2ScoreElement = document.getElementById('player2Score');
                if (player2ScoreElement) {
                    player2ScoreElement.textContent = player2.score;
                }
                if (player2.score >= 5) {
                    endGame(2);
                } else {
                    resetBall();
                }
            } else if (ball.x + ball.radius > canvas.width) {
                player1.score++;
                const player1ScoreElement = document.getElementById('player1Score');
                if (player1ScoreElement) {
                    player1ScoreElement.textContent = player1.score;
                }
                if (player1.score >= 5) {
                    endGame(1);
                } else {
                    resetBall();
                }
            }
       
            if (keysPressed[player1.up]) {
                player1.y -= player1.speed;
                player1.y = Math.max(0, player1.y);
            }
            if (keysPressed[player1.down]) {
                player1.y += player1.speed;
                player1.y = Math.min(canvas.height - player1.height, player1.y);
            }
            if (AI == false) {
                if (keysPressed[player2.up]) {
                    player2.y -= player2.speed;
                    player2.y = Math.max(0, player2.y);
                }
                if (keysPressed[player2.down]) {
                    player2.y += player2.speed;
                    player2.y = Math.min(canvas.height - player2.height, player2.y);
                }
            } else {
                moveAI();
            }
        }
       
        window.addEventListener('resize', () => {
            resizeCanvas();
            draw();
        });
       
        resizeCanvas();
       
        function startGame(mode) {
            hideStartMenu();
            hideGamemodeMenu();
            hideControlsPage();
            hideDifficultyMenu();
            showGameCanvas();
       
            player1 = {
                x: 120,
                y: canvas.height / 2 - 185 / 2,
                dy: 0,
                speed: 8,
                height: 185,
                color: '#45aee6',
                up: 'w',
                down: 's',
                score: 0
            };
       
            player2 = {
                x: canvas.width - 120,
                y: canvas.height / 2 - 185 / 2,
                dy: 0,
                speed: 8,
                height: 185,
                color: '#e65045',
                up: 'ArrowUp',
                down: 'ArrowDown',
                score: 0
            };
       
            ball = {
                x: canvas.width / 2,
                y: canvas.height / 2,
                radius: 15,
                speedX: 5,
                speedY: 5,
                maxSpeed: 10,
                speedIncrement: 1,
                color: 'white'
            };
       
            document.addEventListener('keydown', keyDownHandler, false);
            document.addEventListener('keyup', keyUpHandler, false);
       
            draw();
       
            drawInterval = setInterval(draw, 1000 / 60);
            eventInterval = setInterval(handleRandomEvent, 10000);
        }
       
        function endGame(winner) {
            clearInterval(drawInterval);
            clearInterval(eventInterval);
       
            const winnerText = document.createElement('p');
            winnerText.textContent = `Player ${winner} won! Congrats! Do you want to play this game again?`;
           
            const playAgainButton = document.createElement('button');
            playAgainButton.textContent = 'Play Again';
            playAgainButton.addEventListener('click', () => {
                location.reload();
            });
       
            const gameResultContainer = document.getElementById('gameResult');
            gameResultContainer.appendChild(winnerText);
            gameResultContainer.appendChild(playAgainButton);
            gameResultContainer.style.display = 'block';
       
            canvas.style.display = 'none';
        }
        getPong();
    </script>
</body>
</html>
